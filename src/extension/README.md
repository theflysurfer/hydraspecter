# HydraSpecter Inject

Chrome extension that injects CSS/JS rules from HydraSpecter into your browser.

## Installation

### 1. Install Native Messaging Host

```powershell
# Run from project root
.\src\native-host\install.ps1
```

### 2. Load Extension in Chrome

1. Open `chrome://extensions`
2. Enable **Developer mode** (top right toggle)
3. Click **Load unpacked**
4. Select folder: `<project>/src/extension`

### 3. Verify Installation

1. Click the HydraSpecter icon in the toolbar
2. Should show "0 Total Rules" initially
3. Click "Refresh Rules" to sync

## Usage

### Create Rules in HydraSpecter (Claude)

```javascript
// 1. Create browser and inject CSS
browser({ action: "create", target: "https://google.com" })
browser({ action: "inject_css", pageId: "...", options: {
  css: "body { background: #1a1a1a !important; }"
}})

// 2. Save as rule
browser({ action: "save_rule", options: {
  name: "Google Dark Mode",
  urlPattern: "*://www.google.com/*",
  css: "body { background: #1a1a1a !important; }"
}})

// 3. Publish to extension
browser({ action: "publish_rule", options: { ruleId: "google-dark-mode-xxx" } })
```

### View Rules in Extension

- Click extension icon to see active rules
- Badge shows count of rules active on current page
- Rules auto-refresh every 30 seconds

## Files

```
hydraspecter/
├── src/
│   ├── extension/           # Chrome extension
│   │   ├── manifest.json
│   │   ├── background.js
│   │   ├── content.js
│   │   ├── popup.html
│   │   └── popup.js
│   ├── native-host/         # Native messaging host
│   │   ├── host.js
│   │   ├── host.bat
│   │   ├── manifest.json    # Auto-generated by install.ps1
│   │   └── install.ps1
│   └── injection/           # HydraSpecter injection module
└── ~/.hydraspecter/
    └── injection-rules.json # Rules (source of truth)
```

## Troubleshooting

### "Native host not found"

1. Run `install.ps1` from the project directory
2. Restart Chrome after installation
3. Check registry: `HKCU:\SOFTWARE\Google\Chrome\NativeMessagingHosts\com.hydraspecter.inject`

### Rules not applying

1. Check rule status is `prod` (not `dev`)
2. Check rule is `enabled: true`
3. Click "Refresh Rules" in popup
4. Check URL pattern matches current page

### Update icons

```bash
cd src/extension/icons
npm install sharp
node generate-icons.js
```
