<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; width: 340px; background: #1a1a2e; color: #eee; font-size: 12px; }
    .header { padding: 12px 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: space-between; }
    .header-left { display: flex; align-items: center; gap: 10px; }
    .header h1 { font-size: 14px; font-weight: 600; }
    .header .logo { width: 22px; height: 22px; background: rgba(255,255,255,0.2); border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; }
    .tabs { display: flex; background: #16213e; border-bottom: 1px solid #0f3460; }
    .tab { flex: 1; padding: 8px; text-align: center; cursor: pointer; border: none; background: none; color: #888; font-size: 11px; }
    .tab:hover { color: #ccc; }
    .tab.active { color: #667eea; border-bottom: 2px solid #667eea; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .stats { display: flex; padding: 10px 16px; gap: 12px; background: #16213e; }
    .stat { flex: 1; text-align: center; }
    .stat-value { font-size: 18px; font-weight: 700; color: #667eea; }
    .stat-label { font-size: 9px; color: #888; text-transform: uppercase; }
    .section { padding: 10px 16px; }
    .section-title { font-size: 9px; font-weight: 600; color: #667eea; text-transform: uppercase; margin-bottom: 6px; }
    .rules-list { max-height: 120px; overflow-y: auto; }
    .rule { display: flex; align-items: center; padding: 6px 8px; background: #16213e; border-radius: 4px; margin-bottom: 4px; gap: 8px; }
    .rule-icon { width: 6px; height: 6px; border-radius: 50%; background: #4CAF50; }
    .rule-info { flex: 1; min-width: 0; }
    .rule-name { font-size: 11px; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .rule-pattern { font-size: 9px; color: #666; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .rule-badge { font-size: 9px; padding: 2px 4px; border-radius: 3px; background: #0f3460; color: #667eea; }
    .rule-toggle { position: relative; width: 32px; height: 18px; flex-shrink: 0; }
    .rule-toggle input { opacity: 0; width: 0; height: 0; }
    .rule-toggle .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #333; border-radius: 18px; transition: 0.2s; }
    .rule-toggle .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 2px; bottom: 2px; background: #666; border-radius: 50%; transition: 0.2s; }
    .rule-toggle input:checked + .slider { background: #667eea; }
    .rule-toggle input:checked + .slider:before { transform: translateX(14px); background: white; }
    .rule.disabled .rule-icon { background: #666; }
    .rule.disabled .rule-name { color: #666; }
    .empty { text-align: center; padding: 12px; color: #666; font-size: 11px; }
    .actions { padding: 10px 16px; border-top: 1px solid #0f3460; }
    .btn { width: 100%; padding: 8px; border: none; border-radius: 4px; font-size: 11px; font-weight: 500; cursor: pointer; }
    .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
    .btn-primary:hover { opacity: 0.9; }
    .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }
    .last-sync { text-align: center; font-size: 9px; color: #666; padding: 6px; }
    .current-page { padding: 6px 16px; background: #0f3460; font-size: 10px; }
    .current-page-label { color: #667eea; font-size: 8px; text-transform: uppercase; }
    .current-page-url { color: #888; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    /* Debug styles */
    .debug-section { padding: 10px 16px; background: #0d1117; border-top: 1px solid #30363d; }
    .debug-title { font-size: 9px; color: #f0883e; text-transform: uppercase; margin-bottom: 6px; }
    .debug-item { background: #161b22; padding: 6px 8px; border-radius: 4px; margin-bottom: 4px; font-family: 'Consolas', monospace; font-size: 10px; }
    .debug-label { color: #8b949e; font-size: 9px; }
    .debug-value { color: #c9d1d9; word-break: break-all; }
    .debug-value.success { color: #3fb950; }
    .debug-value.error { color: #f85149; }
    .debug-btn { background: #21262d; border: 1px solid #30363d; color: #c9d1d9; padding: 5px 8px; border-radius: 3px; cursor: pointer; font-size: 10px; margin-right: 4px; margin-top: 4px; }
    .debug-btn:hover { background: #30363d; }
    .debug-log { max-height: 100px; overflow-y: auto; background: #0d1117; padding: 6px; border-radius: 4px; font-family: 'Consolas', monospace; font-size: 9px; }
    .log-entry { color: #8b949e; margin-bottom: 2px; }
    .log-entry.error { color: #f85149; }
    .log-entry.info { color: #58a6ff; }
    .status-dot { display: inline-block; width: 8px; height: 8px; border-radius: 50%; margin-right: 4px; }
    .status-dot.success { background: #3fb950; }
    .status-dot.error { background: #f85149; }
    .status-dot.pending { background: #f0883e; }
    .hint { font-size: 9px; color: #8b949e; background: #21262d; padding: 4px 6px; border-radius: 3px; margin-top: 2px; }
  </style>
</head>
<body>
  <div class="header">
    <div class="header-left">
      <div class="logo">H</div>
      <h1>HydraSpecter Inject</h1>
    </div>
  </div>

  <div class="tabs">
    <button class="tab active" data-tab="main">Rules</button>
    <button class="tab" data-tab="cookies">Cookies</button>
    <button class="tab" data-tab="debug">Debug</button>
  </div>

  <!-- Main Tab -->
  <div class="tab-content active" id="tab-main">
    <div class="current-page">
      <div class="current-page-label">Current Page</div>
      <div class="current-page-url" id="currentUrl">-</div>
    </div>
    <div class="stats">
      <div class="stat"><div class="stat-value" id="totalRules">0</div><div class="stat-label">Total</div></div>
      <div class="stat"><div class="stat-value" id="activeRules">0</div><div class="stat-label">Active</div></div>
    </div>
    <div class="section">
      <div class="section-title">Active Rules</div>
      <div class="rules-list" id="rulesList"><div class="empty">No matching rules</div></div>
    </div>
    <div class="actions"><button class="btn btn-primary" id="refreshBtn">Refresh Rules</button></div>
    <div class="last-sync" id="lastSync">Never synced</div>
  </div>

  <!-- Cookies Tab -->
  <div class="tab-content" id="tab-cookies">
    <div class="section">
      <div class="section-title">Export Cookies to HydraSpecter</div>
      <p style="font-size: 10px; color: #888; margin-bottom: 12px; line-height: 1.4;">
        Export your Chrome cookies to HydraSpecter profiles. This lets you use logged-in sessions without Google blocking automation.
      </p>
      <button class="btn btn-primary" id="exportGoogleBtn" style="margin-bottom: 8px;">
        Export Google Cookies
      </button>
      <button class="btn" id="exportAllBtn" style="background: #21262d; color: #c9d1d9; border: 1px solid #30363d;">
        Export All Cookies
      </button>
    </div>
    <div class="section">
      <div class="section-title">Export Status</div>
      <div class="debug-item">
        <div class="debug-label">Last Export</div>
        <div class="debug-value" id="lastExport">Never</div>
      </div>
      <div class="debug-item">
        <div class="debug-label">Result</div>
        <div class="debug-value" id="exportResult">-</div>
      </div>
    </div>
    <div class="section" style="background: #0f3460; border-radius: 4px; padding: 10px;">
      <div style="font-size: 10px; color: #667eea; font-weight: 600; margin-bottom: 4px;">How it works</div>
      <div style="font-size: 9px; color: #888; line-height: 1.5;">
        1. Login to Google/sites in this Chrome browser<br>
        2. Click "Export Google Cookies"<br>
        3. Cookies are saved to HydraSpecter pools<br>
        4. HydraSpecter will use these sessions
      </div>
    </div>
  </div>

  <!-- Debug Tab -->
  <div class="tab-content" id="tab-debug">
    <div class="debug-section">
      <div class="debug-title">Extension</div>
      <div class="debug-item"><div class="debug-label">ID</div><div class="debug-value" id="extId">-</div></div>
      <div class="debug-item"><div class="debug-label">Version</div><div class="debug-value" id="extVersion">-</div></div>
    </div>
    <div class="debug-section">
      <div class="debug-title">Native Host</div>
      <div class="debug-item">
        <div class="debug-label">Status</div>
        <div class="debug-value" id="nativeStatus"><span class="status-dot pending"></span>Not tested</div>
      </div>
      <div id="nativeDetails"></div>
      <button class="debug-btn" id="testNativeBtn">Test Connection</button>
    </div>
    <div class="debug-section">
      <div class="debug-title">Storage</div>
      <div class="debug-item"><div class="debug-label">Rules</div><div class="debug-value" id="storageRules">-</div></div>
      <div class="debug-item"><div class="debug-label">Source</div><div class="debug-value" id="storageSource">-</div></div>
      <div class="debug-item"><div class="debug-label">Last Error</div><div class="debug-value" id="storageError">None</div></div>
    </div>
    <div class="debug-section">
      <div class="debug-title">Log</div>
      <div class="debug-log" id="debugLog"><div class="log-entry">Click Load to view</div></div>
      <button class="debug-btn" id="loadLogBtn">Load</button>
      <button class="debug-btn" id="clearLogBtn">Clear</button>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
